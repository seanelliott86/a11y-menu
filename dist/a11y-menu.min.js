function WidthChange(e){e.matches?menubar.option.horizontalMenu=!0:menubar.option.horizontalMenu=!1}var A11yMenu=function(e,t){"use strict";var n={tapStop:!1,itemClass:".js-menu-items",subMenuClass:".js-sub-menu",activeClass:"is-active",openClass:"is-shown",animateClass:"is-revealed",horizontalMenu:!0};this.menu=e,this.option=function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e}(n,t||{}),this.bndEvt=this.eventHandler.bind(this),this.nodeObj={activeIndex:null,menuItems:null,menuLinks:[],subMenus:[],activeSubMenu:null,subMenuOpen:!1},this.docActive=null};A11yMenu.prototype.init=function(){var e=this.nodeObj,t=this.option,n=this.menu,i=n.querySelectorAll(t.itemClass);e.menuItems=i;for(var o=0,s=i.length;o<s;o++){var u=i[o],a=u.querySelector("a[href],button:not([disabled])");if(e.menuLinks.push(a),t.tapStop&&(a.tabIndex=o?-1:0),a.hasAttribute("aria-haspopup")){var l=u.querySelector(t.subMenuClass);e.subMenus.push(l)}else e.subMenus.push(null)}n.addEventListener("click",this.bndEvt,!1),n.addEventListener("keydown",this.bndEvt,!1),n.classList.add("is-ready")},A11yMenu.prototype.allowKey=function(e,t){if(-1===e.indexOf(t))return!0},A11yMenu.prototype.focusable=function(e){for(var t=e.querySelectorAll("a[href],button:not([disabled])"),n=[],i=0;i<t.length;i++)0!==t[i].offsetHeight&&n.push(t[i]);return n},A11yMenu.prototype.eventHandler=function(e){var t=this.nodeObj,n="which"in e?e.which:e.keyCode;this.docActive=document.activeElement;var i=t.subMenuOpen,o=!!i&&t.activeSubMenu.contains(this.docActive);if("keydown"===e.type)if(i&&27===n&&(t.menuLinks[t.activeIndex].focus(),this.closeSub()),o||this.allowKey([38,40,37,39,32,13,27,9,16,36,35],n))o&&this.travelSub(e,n);else if(this.travelMain(e,n),i||this.openEvent(e,n),i){if(this.allowKey([40,38],n))return!1;var s=this.focusable(t.activeSubMenu);(38===n?s[s.length-1]:s[0]).focus(),e.preventDefault()}},A11yMenu.prototype.travelMain=function(e,t){var n=this.nodeObj,i=n.menuLinks,o=i.indexOf(this.docActive),s=i.length-1,u=this.option.horizontalMenu?[35,36,37,39]:[35,36,38,40];if(this.allowKey(u,t))return!1;if(this.homeEnd(e,i,t),37===t||38===t?o=0===o?s:o-1:39!==t&&40!==t||(o=o===s?0:o+1),!this.allowKey([37,39,38,40],t)){if(i[o].focus(),this.option.tapStop){for(var a=0;a<i.length;a++)i[a].tabIndex=-1;i[o].tabIndex=0}e.preventDefault()}if(n.subMenuOpen){var l=null!==n.subMenus[o]?o:void 0;this.closeSub(l)}},A11yMenu.prototype.closeSub=function(e){this.toggleState(!1),void 0!==e&&this.openSub(e)},A11yMenu.prototype.openEvent=function(e,t){var n=this.nodeObj.menuLinks.indexOf(this.docActive),i=this.option.horizontalMenu?[32,13,38,40]:[32,13,37,39];if(this.allowKey(i,t)||e.target.classList.contains(this.option.activeClass))return!1;38===t||37===t?this.openSub(n,!1):this.openSub(n,!0),e.preventDefault()},A11yMenu.prototype.openSub=function(e,t){var n=this.nodeObj.subMenus[e];this.nodeObj.activeIndex=e,this.toggleState(!0);var i=this.focusable(n);void 0!==t&&i[e=!0===t?0:i.length-1].focus()},A11yMenu.prototype.toggleState=function(e){var t=this.nodeObj,n=this.option,i=t.activeIndex,o=t.menuLinks[i],s=t.subMenus[i],u=t.menuItems[i];o.classList.toggle(n.activeClass,e),u.classList.toggle(n.animateClass,e),o.setAttribute("aria-expanded",e),t.subMenuOpen=e,t.activeSubMenu=e?s:null},A11yMenu.prototype.travelSub=function(e,t){if(this.allowKey([37,38,39,40,9,35,36],t))return!1;var n=this.nodeObj,i=this.option,o=n.activeSubMenu,s=this.focusable(o),u=s.length-1,a=this;if(i.tapStop){for(var l=0;l<s.length;l++)s[l].tabIndex=-1;s[0].tabIndex=0}this.homeEnd(e,s,t);(function(){if(a.allowKey([38,40],t))return!1;var n=s.indexOf(a.docActive);s[n=40===t?n===u?0:n+1:0===n?u:n-1].focus(),e.preventDefault()})(),function(){if(a.allowKey([37,39],t)||!a.option.horizontalMenu)return!1;var i=n.subMenus,s=n.menuLinks,u=i.indexOf(o),l=i.length-1;if(u=37===t?0===u?l:u-1:u===l?0:u+1,s[u].focus(),a.option.tapStop){for(var r=0;r<s.length;r++)s[r].tabIndex=-1;s[u].tabIndex=0}var h=null!==i[u]?u:void 0;a.closeSub(h),e.preventDefault()}(),function(){if(9!==t||i.tapStop)return!1;e.shiftKey&&a.docActive===s[0]?(s[u].focus(),e.preventDefault()):e.shiftKey||a.docActive!==s[u]||(s[0].focus(),e.preventDefault())}()},A11yMenu.prototype.homeEnd=function(e,t,n){if(this.allowKey([35,36],n))return!1;t[36===n?0:t.length-1].focus(),e.preventDefault()};var elem=document.querySelector(".js-a11y-menu"),menubar=new A11yMenu(elem);menubar.init();var mq=window.matchMedia("(min-width: 990px)");mq.addListener(WidthChange),WidthChange(mq);